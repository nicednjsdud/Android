# 서비스, BR, CP

## 1. 서비스

### 1) 사용자 인터페이스 없이 백그라운드에서 실행되는 컴포넌트

- 배경 음악 재생
- 웹 사이트에서 주기적으로 데이터를 읽음.

### 2) 종류

#### 시작 타입의 서비스

- 액티비티가 startService()를 호출하여서 서비스를 시작

#### 연결 타입의 서비스

- 액티비티가 bindService()를 호출하여서 서비스를 시작

## 2. 방송 수신자 (BR)

- Broadcast Receiver
- 안드로이드 장치에서는 많은 이벤트들이 발생함.
- 이벤트를 받는 컴포넌트가 방송 수신기임.
  - 문자 메세지 도착, 배터리 방전, SD카드 탈부착,

### 1) onReceive()

- 방송이 수신되면 이 메서드가 호출이됨.

### 2) registerReciver()

- API 레벨 26부터 방송수신자는 반드시 이 메서드 사용하여 코드에서 등록해야 함.

## 3. Content Provider (콘텐트 제공자)

![alt](/assets/images/post/Android/41.png)

- 안드로이드는 보안상 앱에서 사용하는 데이터를 외부에서 접근할 수가 없음.
- 다른 애플리케이션에 데이터를 공급하는 역할을 하는 컴포넌트임.
  - 애플리케이션 간에 데이터를 공유하는 수단이 바로 컨텐트 제공자임.
- 데이터 공급을 추상화하여서 데이터 계층과 애플리케이션 계층을 분리하는 역할을 함.
- 컨텐트 제공자는 데이터를 캡슐화하고, 데이터 보안을 정의하는데 필요한 메커니즘 제공함.

### Browser

- 북마크, 웹 검색 기록 등을 제공

### CallLog

- 부재중 전화, 착신 기록, 발신 기록 등을 제공함.

### ContactsContract

- 주소록 기록을 제공

### MediaStore

- 오디오, 비디오, 이미지 등의 멀티미디어 데이터를 제공함.

### Calendar

- 일정, 이벤트, 참석자 등의 데이터를 제공

### Setting

- 장치의 환경 설정 데이터를 제공

### UserDictionary

- 자동 입력에 사용되는 사용자가 정의한 사전을 제공

## 4. MediaStore

- Android 10 (API 29)부터 "제한된 저장소(Scoped Storage)" 개념이 적용되기 시작함.
- 예전에는 미디어 파일(이미지, 동영상, 오디오 파일들)들을 사용자가 직접 외부 저장소(SDCard)에  
  저장할 수 있었지만, 이제는 **MediaStore**를 통해 읽거나 쓰도록 권장하고 있음.

## 5. 컨텐트 제공자 접근

![alt](/assets/images/post/Android/42.png)

- ContentResolver 객체의 메서드가 CRUD 기능 제공함

## 6. 컨텐트 URI

- 안드로이드에 내정되어 있는 콘텐트 제공자들은 URI 객체를 상수로 재공하고 있음.

```
  ex) UserDictionary.Words.CONTENT_URI
```

### 1) MediaStore 사용하여 파일 열기

#### ex) 미디어 타입

- 이미지, 비디오, 오디오

```java
  MediaStor.Images.Media.EXTERNAL_CONTENT_URI
```

## 7. 콘텐츠 제공자로부터 데이터 읽기

- 쿼리를 작성하여 실행함
- 쿼리를 결과로 반환된 레코드들을 커서 객체를 통해 순회하면서 처리함.

### 1) 권한 표시

- 콘텐츠 제공자를 통하여 데이터를 읽을 수 있는 권한을 매니페스트 파일에 표시함.
